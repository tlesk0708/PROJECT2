<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luksood GU</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- เชื่อมต่อ Chart.js -->
</head>

<header>
    <div class="logo">
        <img src="detective.png" alt="Logo">
        <span>Luksood GU.</span>
    </div>
    <span style="font-size: 30px;">คณะที่แนะนำ</span>
    <div class="right-text">
        <span>แนะนำคณะที่ใช่</span>
    </div>
</header>

<body>
    <div class="body">
        <div class="body1">
            <div class="imegebox3">
                <div class="whitebox3">
                    <h1 style="text-align: center;">ผลลัพธ์</h1>
                    <!-- แสดงกราฟ Pie Chart -->
                    <div class="charts-container" style="display: flex; justify-content: space-around; margin-top: 20px;">
                        <div style="width: 50%;">
                            <canvas id="chart1"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="botton">
            <form action="Assessment.html">
                <p>ทำแบบประเมิน</p>
                <div class="input-group">
                    <button type="submit" class="btn2">NEXT</button>
                </div>
            </form>
        </div>
    </div>

    <!-- สคริปต์สำหรับสร้างกราฟ -->
    <script>
        // ดึงคะแนน RIASEC จาก localStorage
        const R_score = parseInt(localStorage.getItem('totalScore_R')) || 0;
        const I_score = parseInt(localStorage.getItem('totalScore_I')) || 0;
        const A_score = parseInt(localStorage.getItem('totalScore_A')) || 0;
        const S_score = parseInt(localStorage.getItem('totalScore_S')) || 0;
        const E_score = parseInt(localStorage.getItem('totalScore_E')) || 0;
        const C_score = parseInt(localStorage.getItem('totalScore_C')) || 0;
    
        // สร้างอาร์เรย์เก็บค่าคะแนนของแต่ละหมวด
        let RIASEC_Scores = [
            { type: 'R', score: R_score, faculty: 'คณะวิศวกรรมศาสตร์' },
            { type: 'I', score: I_score, faculty: 'คณะวิทยาศาสตร์และเทคโนโลยี' },
            { type: 'A', score: A_score, faculty: 'คณะศิลปกรรมศาสตร์' },
            { type: 'S', score: S_score, faculty: 'คณะศิลปศาสตร์' },
            { type: 'E', score: E_score, faculty: 'คณะบริหารธุรกิจ' },
            { type: 'C', score: C_score, faculty: 'คณะเทคโนโลยีคหกรรมศาสตร์' }
        ];
    
        // เรียงลำดับคะแนนจากมากไปน้อย
        RIASEC_Scores.sort((a, b) => b.score - a.score);
    
        // เลือก 3 อันดับแรก
        let top3 = RIASEC_Scores.slice(0, 3);
    
        // ดึงข้อมูลสำหรับกราฟ
        const chartLabels = top3.map(item => item.faculty);
        const chartData = top3.map(item => item.score);
        const chartColors = ['#FF6384', '#36A2EB', '#FFCE56']; // สีของแต่ละส่วน
    
        // สร้าง Plugin แสดงข้อความบน Pie Chart
        Chart.register({
            id: 'textPlugin',
            afterDraw(chart) {
                const ctx = chart.ctx;
                const datasets = chart.data.datasets[0];
                const meta = chart.getDatasetMeta(0);
    
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#000';
    
                meta.data.forEach((arc, index) => {
                    const { x, y } = arc.tooltipPosition();
                    const value = datasets.data[index];
                    const label = chart.data.labels[index];
    
                    ctx.fillText(`${label}: ${value}`, x, y);
                });
            }
        });
    
        // สร้าง Pie Chart
        const ctx1 = document.getElementById('chart1').getContext('2d');
        new Chart(ctx1, {
            type: 'pie',
            data: {
                labels: chartLabels,
                datasets: [{
                    data: chartData,
                    backgroundColor: chartColors,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    }
                }
            },
            plugins: ['textPlugin'] // เพิ่ม Plugin แสดงข้อความ
        });
    </script>
    

<script src="score.js"></script>
    
</body>
</html>
