<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luksood GU.</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    
    <style>
        .body1 {
            background-image: url('dna.png');
            background-size: cover;
            background-position: center;
            padding: 20px;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .whitebox3 {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .charts-container {
    display: flex;
    justify-content: center; /* จัดแนวกาฟให้อยู่ตรงกลางในแนวนอน */
    align-items: center; /* จัดกราฟให้อยู่ตรงกลางในแนวตั้ง */
    width: 100%; /* ใช้ความกว้าง 100% ของพื้นที่ */
    height: 400px; /* กำหนดความสูงของกราฟ */
}

canvas {
    max-width: 100%;
    max-height: 100%; /* กำหนดความสูงสูงสุด */
}


        .btn2 {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
        }

        .btn2:hover {
            background-color: #45a049;
        }

        .faculty-details {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 10px;
            display: none;
            text-align: center;
        }
    </style>
</head>

<header>
    <div class="logo">
        <img src="detective.png" alt="Logo">
        <span>Luksood GU.</span>
    </div>
    <span style="font-size: 30px;">คณะที่แนะนำ</span>
    <div class="right-text">
        <span>แนะนำคณะที่ใช่</span>
    </div>
</header>

<body>
    <div class="body">
        <div class="body1">
            <div class="imegebox3">
                <div class="whitebox3">
                    <h1>ผลลัพธ์</h1>
                    <div class="result-box">
                        <ul id="facultyList"></ul>
                    </div>
                    <h3>เลือกกราฟเพื่อแสดงรายละเอียด</h3>
                    <div class="charts-container">
                        <div style="width:100%">
                            <canvas id="chart1"></canvas>
                        </div>
                    </div>
                    <div class="result-box">
                        <div class="result" id="result"></div>
                        <div class="description" id="description"></div>
                    </div>
                    <!-- รายละเอียดของคณะที่เลือก -->
                    <div id="facultyDetails" class="faculty-details"></div>
                </div>
            </div>
        </div>
        


        <div class="botton">
            <form action="Assessment.html">
                <p>ทำแบบประเมิน</p>
                <div class="input-group">
                    <button type="submit" class="btn2">NEXT</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            recommendFaculty();
        });

        function recommendFaculty() {
            let riasecScores = {
                R: parseInt(localStorage.getItem('totalScore_R')) || 0,
                I: parseInt(localStorage.getItem('totalScore_I')) || 0,
                A: parseInt(localStorage.getItem('totalScore_A')) || 0,
                S: parseInt(localStorage.getItem('totalScore_S')) || 0,
                E: parseInt(localStorage.getItem('totalScore_E')) || 0,
                C: parseInt(localStorage.getItem('totalScore_C')) || 0
            };
            
            let mbtiResult = localStorage.getItem('MBTI_result') || "";
            let facultyList = [
                { name: "คณะเทคโนโลยีการเกษตร", score: (riasecScores.R + riasecScores.I + riasecScores.S), mbti: ["ENFP","ISTP"], details: "เหมาะกับคนชอบธรรมชาติ สนใจการพัฒนาเกษตรกรรม การจัดการและส่งเสริมทางการเกษตร" },
                { name: "คณะเทคโนโลยีคหกรรมศาสตร์", score: (riasecScores.R + riasecScores.S + riasecScores.A), mbti: ["INFP", "ISFJ"], details: "เหมาะกับคนชอบงานบ้าน อาหาร แฟชั่นเครื่องแต่งกาย และนักโภชนาการและนวัตกรรมด้านอาหาร" },
                { name: "คณะเทคโนโลยีสื่อสารมวลชน", score: (riasecScores.A + riasecScores.S + riasecScores.E), mbti: ["ISFP", "ENFP", "ESFP"], details: "เหมาะกับคนที่ชอบการสื่อสาร การเล่าเรื่อง การผลิตสื่อทั้งแบบดั้งเดิมและดิจิทัล" },
                { name: "คณะการแพทย์บูรณาการ", score: (riasecScores.I + riasecScores.S + riasecScores.E), mbti: ["ISFJ", "INFJ","ISTJ"], details: "เหมาะกับคนที่สนใจศาสตร์ทางการแพทย์ สุขภาพ และการแพทย์ประยุกต์" },
                { name: "คณะครุศาสตร์อุตสาหกรรม", score: (riasecScores.R + riasecScores.S + riasecScores.E), mbti: ["ISFJ", "ENFJ", "ESTJ"], details: "เหมาะกับคนที่ชอบงานสอน ควบคู่กับนักวิชาการในด้านเทคโนโลยีและนวัตกรรมอุตสาหกรรมต่างๆ" },
                { name: "คณะบริหารธุรกิจ", score: (riasecScores.E + riasecScores.C + riasecScores.I), mbti: ["ENTJ", "ENTP", "ENFP", "ESTJ","ESTP","INTJ","INFJ","ISTJ"], details: "เหมาะกับคนที่ชอบการจัดการ วางแผนธุรกิจ หรือทำงานด้านการตลาด การเงิน" },
                { name: "คณะพยาบาลศาสตร์", score: (riasecScores.S + riasecScores.C + riasecScores.I), mbti: ["ESFJ", "ISTJ", "ISFJ"], details: "เหมาะกับคนที่มีความเมตตา ต้องการดูแลช่วยเหลือผู้อื่น และทำงานอย่างเป็นระบบ" },
                { name: "คณะวิทยาศาสตร์และเทคโนโลยี", score: (riasecScores.R + riasecScores.I + riasecScores.C), mbti: ["INTP", "ISTP"], details: "เหมาะกับคนที่ชอบการวิเคราะห์ ค้นคว้า คิดเชิงตรรกะ และแก้ปัญหาเชิงวิทยาศาสตร์" },
                { name: "คณะวิศวกรรมศาสตร์", score: (riasecScores.R + riasecScores.I + riasecScores.E), mbti: ["ENTP", "INTJ", "ISTP"], details: "เหมาะกับคนที่ชอบงานเทคนิค คำนวณ ระบบเครื่องจักร และการออกแบบโครงสร้าง" },
                { name: "คณะศิลปกรรมศาสตร์", score: (riasecScores.A + riasecScores.R + riasecScores.E), mbti: ["ESTP", "ESFP", "INFP", "ISFP"], details: "เหมาะกับคนที่มีความคิดสร้างสรรค์ ชอบการออกแบบ ศิลปะ ดนตรี หรือการแสดง" },
                { name: "คณะศิลปศาสตร์", score: (riasecScores.A + riasecScores.S + riasecScores.E), mbti: ["ESFJ", "ENTJ", "ENFJ"], details: "เหมาะกับคนที่สนใจด้านภาษา วรรณกรรม จิตวิทยา หรือปรัชญา" },
                { name: "คณะสถาปัตยกรรมศาสตร์", score: (riasecScores.A + riasecScores.R + riasecScores.E), mbti: ["INTP", "INFP"], details: "เหมาะกับคนที่สนใจการออกแบบเชิงสร้างสรรค์ และมีทักษะเชิงเทคนิคด้านโครงสร้าง" }
];
            
            let matchedFaculties = facultyList.filter(faculty => faculty.mbti.includes(mbtiResult));
            matchedFaculties.sort((a, b) => b.score - a.score);
            let topFaculties = matchedFaculties.slice(0, Math.min(matchedFaculties.length, 5));

            let facultyListElement = document.getElementById('facultyList');
            facultyListElement.innerHTML = "";
            
            topFaculties.forEach((faculty, index) => {
                let li = document.createElement('li');
                li.innerText = `อันดับที่ ${index + 1}: ${faculty.name} (คะแนน: ${faculty.score})`;
                facultyListElement.appendChild(li);
            });
            
            if (topFaculties.length > 0) {
    const chartLabels = topFaculties.map(item => item.name);
    const chartData = topFaculties.map(item => item.score);
    const chartColors = ['#FF6384', '#36A2EB', '#FFCE56', '#8A2BE2', '#3CB371']
        .slice(0, topFaculties.length);

    const ctx1 = document.getElementById('chart1').getContext('2d');
    const myChart = new Chart(ctx1, {
        type: 'pie',
        data: {
            labels: chartLabels,
            datasets: [{
                data: chartData,
                backgroundColor: chartColors,
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                datalabels: {
                    color: '#000',
                    font: {
                        weight: 'bold',
                        size: 10
                    },
                    formatter: (value, ctx) => {
                        let label = ctx.chart.data.labels[ctx.dataIndex];
                        return `${label} (${value} คะแนน)`;
                    }
                }
            },
            onClick: (e, elements) => {
                if (elements.length > 0) {
                    const idx = elements[0].index;
                    const facultyDetails = topFaculties[idx].details;
                    document.getElementById('facultyDetails').innerText = facultyDetails;
                    document.getElementById('facultyDetails').style.display = 'block';
                }
            }
        },
        plugins: [ChartDataLabels]
    });

    // สร้าง Legend แยกต่างหาก
    const legendContainer = document.getElementById('customLegend');
    legendContainer.innerHTML = ''; // เคลียร์ของเก่าออกก่อน

    chartLabels.forEach((label, index) => {
        const legendItem = document.createElement('div');
        legendItem.classList.add('legend-item');
        legendItem.innerHTML = `
            <span class="legend-color" style="background-color: ${chartColors[index]};"></span>
            <span class="legend-text">${label}</span>
        `;
        legendContainer.appendChild(legendItem);
    });

            } else {
                alert("ไม่พบคณะที่ตรงกับผลลัพธ์ของคุณ");
            }
        }

        const mbtiDescriptions = {
            "ISTJ": "นักคำนวณ: เป็นคนมีเหตุมีผลและไม่ชอบการตัดสินใจแบบหุนหันพลันแล่น เป็นคนทำงานที่ดีเพราะคุณเป็นคนที่ไว้ใจได้ หลักแหลม และไม่มีความลำเอียง เชื่อฟังคนที่มีอำนาจเหนือกว่า และต้องการความมั่นคงปลอดภัย",
            "ISFJ": "ผู้ตั้งรับ: เป็นคนที่ทำงานเก่งและมีความรับผิดชอบ และมีความต้องการที่จะช่วยเหลือคนอื่น บุคลิกของคุณเหมาะมากกับโลกในปัจจุบัน เป็นคนมีทักษะสูงและเอื้อเฟื้อเผื่อแผ่ และคุณแฮปปี้ที่ได้ทำงานเพื่อคนอื่น",
            "INFJ": "นักแก้ปัญหา: เป็นคนที่ชอบทำงานที่ต้องใช้ความคิดอย่างลุ่มลึก เป็นคนมีจินตนาการและเป็นคนที่แคร์คนอื่น แต่ถึงกระนั้นคุณก็ไม่ได้เป็นคนเพ้อฝัน และเป็นคนที่สนใจในทุกข์สุขของคนอื่น และพยายามลงมือทำเพื่อทำให้โลกนี้ดีขึ้น",
            "INTJ": "นักออกแบบ: เป็นคนมีความคิดสร้างสรรค์แต่ก็ยังใส่ใจในรายละเอียด ชอบการทำงานคนเดียว ชอบที่จะคิดวิเคราะห์เพื่อแก้ปัญหา และเป็นคนที่จะมีความต้องการเปลี่ยนระบบ เปลี่ยนกระบวนการ หรือเปลี่ยนอะไรก็ตามที่เข้ามาขวางทาง",
            "ISTP": "ผู้เชี่ยวชาญ: เป็นคนมีความสร้างสรรค์สูงมาก และโฟกัสที่เป้าหมายในการพัฒนาตัวเอง คุณจะไม่ยอมหยุดจนกว่าคุณจะประสบความสำเร็จ คุณเป็นนักแก้ปัญหาที่เก่งกาจแม้ว่าปัญหานั้นดูเป็นสิ่งที่ยากที่จะแก้ไข และเมื่อบวกกับความอยากรู้อยากเห็นและความอดทนอดกลั้น",
            "ISFP": "นักผจญภัย: รักการผจญภัยและใช้ชีวิตอยู่กับปัจจุบัน ไม่ค่อยสนใจเรื่องเงิน อำนาจ หรือความมั่นคงมาก สำหรับอาชีพของคุณนั้น ต้องการอิสระในงานสร้างสรรค์ และได้รับโอกาสที่จะแสดงตัวตนของตัวเองผ่านงานศิลปะ",
            "INFP": "ผู้ไกลเกลี่ย: เป็นคนเงียบ ๆ มีจินตนาการสูง และเป็นคนเปิดกว้าง แม้ว่าคุณจะเป็นคนฉลาด แต่คุณไม่ชอบการเรียนหนังสือในโรงเรียนและไม่ชอบทำอะไรเดิม ๆ ซ้ำ ๆ ดังนั้น งานจำเจจึงไม่เหมาะกับคุณ",
            "INTP": "นักตรรกวิทยา: เป็นคนที่ชอบขบคิดและทดลองไอเดียใหม่ ๆ เป็นคนรักอิสระมาก ๆ และชอบวิเคราะห์ทฤษฎีต่าง ๆ เมื่อคุณคิด จะคิดอย่างลุ่มลึก จึงจะก้าวหน้าในอาชีพที่ให้คุณได้มีส่วนในการร่วมสร้างสรรค์เอง",
            "ESTP": "ผู้ประกอบการ: เป็นคนมีพลังงานล้นเหลือ ทำงานโดยมองไปที่เป้าหมาย และมีแรงผลักดันในการทำงานจากการได้รับผลสำเร็จในระยะสั้น คุณชอบที่จะมีส่วนในการตัดสินใจ และเป็นคนมีไหวพริบปฏิภาณดี คุณจะเข้ากับคนอื่นได้ง่าย และสามารถสร้างเครือข่ายได้ไม่ยาก บุคลิกแบบนี้เป็นบุคลิกที่มีเยอะที่สุด",
            "ESFP": "ผู้มอบความบันเทิง: มักจะเป็นสีสันของงานปาร์ตี้ บางทีคุณก็จะร้องเพลง เต้น และชอบที่จะสร้างสีสัน สร้างพลังงานบวกเพื่อมอบให้กับคนอื่น และหากงานไหนที่พรากอิสระไปจากคุณ คุณจะรู้สึกทุกข์ใจขึ้นมาทันที คุณชอบความตื่นเต้น ชอบเจอเพื่อนใหม่ ๆ และชอบที่จะได้มีโอกาสเฉิดฉาย",
            "ENFP": "นักรณรงค์: เป็นคนรักอิสระ เป็นคนมีเสน่ห์ และมีเอนเนอร์จี้ตลอดเวลา คุณชอบที่จะพูดคุยพบปะผู้คนและได้ลองไอเดียใหม่ ๆ คุณพบว่าทุกสิ่งทุกอย่างรอบตัวน่าสนใจไปหมด",
            "ENTP": "นักโต้วาที: เป็นคนกล้าหาญ มีความคิดสร้างสรรค์ และเป็นนักเสียดสี คุณไม่กลัวถ้าจะต้องทำงานหนักเพื่อให้ไปถึงเป้าหมายที่ตั้งเอาไว้ คุณเป็นคนมีปฏิภาณไหวพริบที่ดี และในการทำงานนั้น คุณสนุกกับการหาวิธีแก้ปัญหาทั้งการแก้ปัญหาด้านเทคนิคและการประลองเชาวน์ความรู้",
            "ESTJ": "นักบริหาร: เป็นผู้นำที่แท้จริง ชอบที่จะนำคนอื่น คุณให้ความเคารพแบบแผนประเพณีและเชื่อมั่นในศีลธรรมอันดีงาม คุณจะชื่นชอบในอาชีพที่มีโครงสร้างและมีความเป็นระเบียบแบบแผนที่แน่นอน ซึ่งงานประเภทนี้จะทำให้คุณได้แสดงความรับผิดชอบและความซื่อสัตย์ออกมา",
            "ESFJ": "ผู้ให้คำปรึกษา: เป็นคนที่ชอบพบปะพูดคุยกับคนอื่นและชื่นชอบที่ได้เป็นส่วนหนึ่งในวงสังคม คุณเป็นคนเอื้อเฟื้อและชอบที่จะช่วยเหลือคนอื่น คุณเป็นคนที่รักใครรักจริงมาก ๆ และเป็นคนมีระเบียบและจะหลีกเลี่ยงความขัดแย้งให้ได้มากที่สุด คุณชอบที่จะทำงานให้เสร็จและไม่ปฏิเสธงานซ้ำซากจำเจ",
            "ENFJ": "ตัวเอก: ชอบที่จะช่วยเหลือคนอื่นและชอบที่จะเป็นจุดสนใจ คุณเป็นคนมีแนวคิดและค่านิยมของตัวเอง และไม่กลัวถ้าจะต้องยืนยันในหลักการนั้น ๆ คุณจะไปถึงเป้าหมายที่ตั้งไว้ได้ผ่านพลังแห่งการสร้างสรรค์และการทำงานเป็นทีม",
            "ENTJ": "ผู้บัญชาการ: เป็นคนที่ตัดสินใจเร็วและมีแรงจูงใจหากงานที่ทำได้รับรับรางวัลหรือคำชม มักจะเป็นผู้นำทีมและมั่นใจในตัวเองสูง คุณจะใช้อำนาจที่มีอยู่ในมือเพื่อให้ทุกคนรับผิดชอบงานตามหน้าที่ของตัวเองและทำให้งานสำเร็จตรงตามเป้าหมาย"
        };

        // ฟังก์ชันแสดงผล MBTI ทันทีเมื่อโหลดหน้าเว็บ
        window.onload = function() {
            // ดึงรหัส MBTI จาก localStorage
            let mbtiResult = localStorage.getItem('MBTI_result');

            // แสดงผลลัพธ์ MBTI
            if (mbtiResult) {
                document.getElementById("result").innerText = "" + mbtiResult;
                document.getElementById("description").innerText = mbtiDescriptions[mbtiResult] || "ไม่พบข้อมูลสำหรับรหัส MBTI นี้";
            } else {
                document.getElementById("result").innerText = "ยังไม่มีผลการคำนวณ MBTI";
                document.getElementById("description").innerText = "";
            }
        }
    </script>
</body>
</html>
